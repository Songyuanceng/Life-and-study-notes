# 1 应用部署方式的演变
## 1.1 应用部署方式的演变
- 在部署应用程序的方式上，主要经历了三个时代
- ① 传统部署：
	* 互联网早期，会直接将应用部署在物理机上
	* 优点：简单，不需要其他的技术参与。
	* 缺点：不能为应用程序定义资源的使用边界，很难合理的分配计算机资源，而且程序之间容易产生影响。
- ② 虚拟化部署：
	* 可以在一台物理机上运行多个虚拟机，每个虚拟机都是独立的一个环境。
	* 优点：程序环境不会相互产生影响，提供了一定程序上的安全性。
	* 缺点：增加了操作系统，浪费了部分资源。
- ③ 容器化部署：
	* 和虚拟化类似，但是共享了操作系统
	* 优点：
		-   ① 可以保证每个容器拥有自己的文件系统、CPU 、内存和进程空间等。
		-   ② 运行应用程序所需要的资源都被容器包装，并和底层基础架构解耦。
		-   ③ 容器化的应用程序可以跨云服务商、跨 Linux 操作系统发行版进行部署。

## 1.2 容器化部署方式产生的问题及解决方案
- 容器化部署方式带来了很多的便利，但是也会带来一些问题，比如：
	- 一旦容器故障停机了，怎么让另外一个容器立刻启动去替补停机的容器。
	- 当并发访问量变大的时候，怎么做到横向扩展容器数量。
	- 。。。。。。
- 这些容器管理的问题统称为：容器编排问题，为了解决这些容器编排问题，就产生了一些容器编排的软件：
	- Swarm：Docker 自己的容器编排工具。
	- Mesos：Apache 的一个资源统一管控工具，需要和Marathon结合。
	- Kubernetes：Google开源的容器编排工具。
	
	
# 2 Kubernetes 简介
- Kubernetes 是一个全新的基于容器技术的分布式架构领先方案，是Google严格保密十几年的秘密武器--Borg系统的一个开源版本，于2014年9月发布的第一个版本，2015年7月发布第一个正式版本。
- Kubernetes 的本质是一组服务器集群，它可以在集群的每个节点上运行特定的程序，来对节点中的容器进行管理。它的目的就是实现资源管理的自动化，主要提供了如下功能：
	- ①自我修复：一旦某一个容器崩溃，能够在1秒左右迅速启动新的容器。
	- ②弹性收缩：可以根据需要，自动对集群中正在运行的容器数量进行调整。
	- ③服务发现：服务可以通过自动发现的形式找到它所依赖的服务。
	- ④负载均衡：如果一个服务启动了多个容器，能够自动实现请求的负载均衡。
	- ⑤版本回退：如果发现新发布的程序版本有问题，可以立即回退到原来的版本。
	- ⑥存储编排：可以根据容器自身的需求自动创建存储卷。
	- 。。。。。。


# 3 Kubernetes 组件
## 3.1 Kubernetes 组件介绍
- 一个kubernetes 集群主要由控制节点(master)、工作节点(node)构成，每个节点上都会安装不同的组件。
- 控制节点(master)：集群的控制平台，负责集群的决策。
	- 》API SERVER：集群操作的唯一入口，接收用户输入的命令，提供认证、授权、API注册和发现等机制。
	- 》Scheduler：负责集群资源调度，按照预定的调度策略将pod调度到相应的node节点上。
	- 》ControllerManager：负责维护集群的状态，比如程序部署安排、故障检测、自动扩展和滚动更新等。
	- 》Etcd：负责存储集群中各种资源对象的信息。
- 工作节点(node)：
	- 》Kubelet：负责维护容器的生命周期，即通过控制docker，创建、更新、销毁容器。
	- 》KubeProxy：负责提供集群内部的服务发现和负载均衡。
	- 》Docker：负责节点上容器的各种操作。

组件图：![[k8s组件.jpg]]

## 3.2 kubernetes 组件调用关系的应用示例
- 以部署一个 Nginx 服务来说明 Kubernetes 系统各个组件调用关系：
- 